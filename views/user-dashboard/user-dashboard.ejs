<% layout("/layouts/boilerplate") %>
<style>
  .card {
    margin: 20px 0;
  }
  .dashboard-title {
    margin-bottom: 30px;
    text-align: center;
  }
  .table-responsive {
    margin-top: 20px;
  }
  .weather-widget {
    text-align: center;
    margin-top: 20px;
  }
</style>

<div class="container">
  <h1 class="dashboard-title">Farmer Dashboard</h1>

  <!-- Dashboard Stats -->
  <div class="row">
    <!-- Total Sales -->
    <div class="col-md-3">
      <div class="card text-white bg-success mb-3">
        <div class="card-header">Total Sales</div>
        <div class="card-body">
          <h5 class="card-title"><%= totalSales %> Sales</h5>
        </div>
      </div>
    </div>

    <!-- Total Listings -->
    <div class="col-md-3">
      <div class="card text-white bg-primary mb-3">
        <div class="card-header">Total Listings</div>
        <div class="card-body">
          <h5 class="card-title"><%= totalListings %> Listings</h5>
        </div>
      </div>
    </div>

    <!-- Earnings -->
    <div class="col-md-3">
      <div class="card text-white bg-warning mb-3">
        <div class="card-header">Earnings</div>
        <div class="card-body">
          <h5 class="card-title">$<%= totalEarnings.toFixed(2) %></h5>
        </div>
      </div>
    </div>

    <!-- Active Orders -->
    <div class="col-md-3">
      <div class="card text-white bg-danger mb-3">
        <div class="card-header">Active Orders</div>
        <div class="card-body">
          <h5 class="card-title"><%= activeOrders %> Orders</h5>
        </div>
      </div>
    </div>
  </div>

  <!-- Top Selling Products -->
  <div class="row">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">Top Selling Products</div>
        <div class="card-body">
          <ul class="list-group">
            <% topSellingProducts.forEach(product => { %>
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <%= product.name %>
              <span class="badge badge-primary badge-pill"
                ><%= product.sales %> Sold</span
              >
            </li>
            <% }) %>
          </ul>
        </div>
      </div>
    </div>

    <!-- Recent Transactions -->
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">Recent Transactions</div>
        <div class="card-body table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Buyer</th>
                <th>Product</th>
                <th>Amount</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <% recentTransactions.forEach(transaction => { %>
              <tr>
                <td><%= transaction.buyerName %></td>
                <td><%= transaction.productName %></td>
                <td>$<%= transaction.amount.toFixed(2) %></td>
                <td><%= transaction.date %></td>
              </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Inventory Status -->
  <div class="row">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">Inventory Status</div>
        <div class="card-body">
          <ul class="list-group">
            <% inventoryStatus.forEach(item => { %>
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <%= item.productName %>
              <span class="badge badge-danger badge-pill"
                ><%= item.stock %> Left</span
              >
            </li>
            <% }) %>
          </ul>
        </div>
      </div>
    </div>

    <!-- Weather Widget -->
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">Weather Forecast</div>
        <div class="card-body weather-widget">
          <h4>Current Weather</h4>
          <p><%= weather.condition %>, <%= weather.temperature %>Â°C</p>
          <p><%= weather.location %></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback and Ratings -->
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">Feedback & Ratings</div>
        <div class="card-body">
          <ul class="list-group">
            <% feedback.forEach(comment => { %>
            <li class="list-group-item">
              <strong><%= comment.buyerName %>:</strong> <%= comment.text %>
              <span class="badge badge-secondary"><%= comment.rating %>/5</span>
            </li>
            <% }) %>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
